#
# Executes commands at the start of an interactive session.
#
# Authors:
#   Sorin Ionescu <sorin.ionescu@gmail.com>
#

# Source Prezto.
if [[ -s "${ZDOTDIR:-$HOME}/.zprezto/init.zsh" ]]; then
  source "${ZDOTDIR:-$HOME}/.zprezto/init.zsh"
fi

# Customize to your needs...
if [ -f $(brew --prefix)/etc/brew-wrap ];then
  source $(brew --prefix)/etc/brew-wrap
fi

if [[ -d '/Volumes/Transcend' ]]; then
  export HOMEBREW_CACHE='/Volumes/Transcend/Caches/Homebrew'
fi

# alias
alias vim8="/usr/local/Cellar/vim/8.0.0055/bin/vim"
alias vim="nvim"
alias ctags="`brew --prefix`/bin/ctags"
alias be='bundle exec'

alias rlogin='sh ~/.rlogin.sh'
export PKG_CONFIG_PATH=/usr/local/opt/imagemagick@6/lib/pkgconfig

# env
eval "$(rbenv init -)"
export GOPATH=$HOME/dev
export PATH=$PATH:$GOPATH/bin

if which pyenv-virtualenv-init > /dev/null; then eval "$(pyenv virtualenv-init -)"; fi

# zshmarks
peco_change_directory() {
  directory_alias=$(showmarks | peco | awk '{print $1}')
  if test -n "${directory_alias}"; then
    jump "${directory_alias}"
    return 0
  fi
  return 1
}

peco_delete_bookmark() {
  directory_alias=$(showmarks | peco | awk '{print $1}')
  if test -n "${directory_alias}"; then
    deletemark "${directory_alias}"
    return 0
  fi
  return 1
}

function peco-src () {
  local selected_dir=$(ghq list -p | peco --query "$LBUFFER")
  if [ -n "$selected_dir" ]; then
    cd "${selected_dir}"
  fi
}

alias cdd=peco-src
alias dbm=peco_delete_bookmark
alias bm=bookmark


function peco-history-selection() {
    BUFFER=`history -n 1 | tail -r  | awk '!a[$0]++' | peco`
    CURSOR=$#BUFFER
    zle reset-prompt
}

alias -g B='`git branch -a | peco --prompt "GIT BRANCH>" | head -n 1 | sed -e "s/^\*\s*//g"`'

zle -N peco-history-selection
bindkey '^R' peco-history-selection

# eval $(docker-machine env)
eval "$(pyenv init -)"

export NVM_DIR="$HOME/.nvm"
. "$(brew --prefix nvm)/nvm.sh"

eval "$(scalaenv init -)"
# export PATH="${HOME}/.scalaenv/bin:${PATH}"
